# üîß –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –æ—à–∏–±–∫–∏ "Failed to fetch user emails"

## –ü—Ä–æ–±–ª–µ–º–∞

–ï—Å–ª–∏ –≤—ã –≤–∏–¥–∏—Ç–µ –æ—à–∏–±–∫—É **"Failed to fetch user emails"** –ø—Ä–∏ –≤—Ö–æ–¥–µ —á–µ—Ä–µ–∑ GitHub, —ç—Ç–æ –æ–∑–Ω–∞—á–∞–µ—Ç, —á—Ç–æ:

1. –í–æ–∑–º–æ–∂–Ω–æ, —Å–æ–∑–¥–∞–Ω **GitHub App** –≤–º–µ—Å—Ç–æ **OAuth App**
2. –ò–ª–∏ scope `user:email` –Ω–µ –∑–∞–ø—Ä–∞—à–∏–≤–∞–µ—Ç—Å—è –ø—Ä–∞–≤–∏–ª—å–Ω–æ
3. –ò–ª–∏ email –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –ø—Ä–∏–≤–∞—Ç–Ω—ã–π –≤ –Ω–∞—Å—Ç—Ä–æ–π–∫–∞—Ö GitHub

## ‚úÖ –†–µ—à–µ–Ω–∏–µ 1: –ü—Ä–æ–≤–µ—Ä—å—Ç–µ —Ç–∏–ø –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è

### GitHub App vs OAuth App

- ‚ùå **GitHub App** ‚Äî –¥–ª—è –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–π (–∞–≤—Ç–æ–º–∞—Ç–∏–∑–∞—Ü–∏—è, –±–æ—Ç—ã, —Ä–∞–±–æ—Ç–∞ —Å —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏—è–º–∏)
- ‚úÖ **OAuth App** ‚Äî –¥–ª—è –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π (—Ç–æ, —á—Ç–æ –Ω–∞–º –Ω—É–∂–Ω–æ)

### –ö–∞–∫ —Å–æ–∑–¥–∞—Ç—å –ø—Ä–∞–≤–∏–ª—å–Ω—ã–π OAuth App:

1. –ü–µ—Ä–µ–π–¥–∏—Ç–µ: https://github.com/settings/developers
2. –í –ª–µ–≤–æ–º –º–µ–Ω—é –Ω–∞–π–¥–∏—Ç–µ —Ä–∞–∑–¥–µ–ª **"OAuth Apps"** (–Ω–µ GitHub Apps!)
3. –ï—Å–ª–∏ –≤—ã —Å–æ–∑–¥–∞–ª–∏ GitHub App –ø–æ –æ—à–∏–±–∫–µ:
   - –£–¥–∞–ª–∏—Ç–µ –µ–≥–æ –∏–ª–∏ –ø—Ä–æ—Å—Ç–æ –Ω–µ –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ
   - –°–æ–∑–¥–∞–π—Ç–µ –Ω–æ–≤—ã–π **OAuth App**

### –°–æ–∑–¥–∞–Ω–∏–µ OAuth App:

1. –ù–∞–∂–º–∏—Ç–µ **"New OAuth App"**
2. –ó–∞–ø–æ–ª–Ω–∏—Ç–µ:
   ```
   Application name: Real-time Chat App
   Homepage URL: https://real-time-information.onrender.com
   Authorization callback URL: https://real-time-information.onrender.com/auth/github/callback
   ```
3. –ù–∞–∂–º–∏—Ç–µ **"Register application"**
4. –°–∫–æ–ø–∏—Ä—É–π—Ç–µ **Client ID**
5. –ù–∞–∂–º–∏—Ç–µ **"Generate a new client secret"** –∏ —Å–∫–æ–ø–∏—Ä—É–π—Ç–µ —Å–µ–∫—Ä–µ—Ç (–ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç—Å—è –æ–¥–∏–Ω —Ä–∞–∑!)

---

## ‚úÖ –†–µ—à–µ–Ω–∏–µ 2: –û–±–Ω–æ–≤–∏—Ç–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –Ω–∞ Render

–ü–æ—Å–ª–µ —Å–æ–∑–¥–∞–Ω–∏—è –ø—Ä–∞–≤–∏–ª—å–Ω–æ–≥–æ OAuth App:

1. –û—Ç–∫—Ä–æ–π—Ç–µ –≤–∞—à —Å–µ—Ä–≤–∏—Å –Ω–∞ Render
2. –ü–µ—Ä–µ–π–¥–∏—Ç–µ –≤ **Environment**
3. –û–±–Ω–æ–≤–∏—Ç–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ:
   ```
   GITHUB_CLIENT_ID=–Ω–æ–≤—ã–π-client-id-–∏–∑-oauth-app
   GITHUB_CLIENT_SECRET=–Ω–æ–≤—ã–π-client-secret-–∏–∑-oauth-app
   GITHUB_CALLBACK_URL=https://real-time-information.onrender.com/auth/github/callback
   ```
4. –°–æ—Ö—Ä–∞–Ω–∏—Ç–µ –∏–∑–º–µ–Ω–µ–Ω–∏—è
5. –ü–æ–¥–æ–∂–¥–∏—Ç–µ 1-2 –º–∏–Ω—É—Ç—ã –¥–ª—è –ø–µ—Ä–µ–∑–∞–ø—É—Å–∫–∞

---

## ‚úÖ –†–µ—à–µ–Ω–∏–µ 3: –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ GitHub –ø—Ä–æ—Ñ–∏–ª—è

–ï—Å–ª–∏ email –ø—Ä–∏–≤–∞—Ç–Ω—ã–π:

1. GitHub ‚Üí Settings ‚Üí Emails
2. –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ —Ö–æ—Ç—è –±—ã –æ–¥–∏–Ω email –æ—Ç–º–µ—á–µ–Ω –∫–∞–∫ **"Public"**
3. –ò–ª–∏ –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ email, –∫–æ—Ç–æ—Ä—ã–π –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –¥–ª—è –≤—Ö–æ–¥–∞ –≤ GitHub

**–í–∞–∂–Ω–æ:** –ü—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –º–æ–∂–µ—Ç —Å–æ–∑–¥–∞—Ç—å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è —Å –≤—Ä–µ–º–µ–Ω–Ω—ã–º email (`username_github@oauth.local`), –µ—Å–ª–∏ email –Ω–µ –ø–æ–ª—É—á–µ–Ω.

---

## ‚úÖ –†–µ—à–µ–Ω–∏–µ 4: –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ª–æ–≥–∏

–ü–æ—Å–ª–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ –ø—Ä–æ–≤–µ—Ä—å—Ç–µ –ª–æ–≥–∏ –Ω–∞ Render:

1. –û—Ç–∫—Ä–æ–π—Ç–µ –≤–∞—à —Å–µ—Ä–≤–∏—Å –Ω–∞ Render
2. –ü–µ—Ä–µ–π–¥–∏—Ç–µ –≤ **Logs**
3. –ü–æ–ø—Ä–æ–±—É–π—Ç–µ –≤–æ–π—Ç–∏ —á–µ—Ä–µ–∑ GitHub
4. –ò—â–∏—Ç–µ –≤ –ª–æ–≥–∞—Ö:
   - `GitHub OAuth callback received`
   - `GitHub API response status: 200` (–¥–æ–ª–∂–Ω–æ –±—ã—Ç—å 200)
   - `GitHub email successfully fetched from API`
   
–ï—Å–ª–∏ –≤–∏–¥–∏—Ç–µ –æ—à–∏–±–∫–∏:
- `401 Unauthorized` ‚Äî –Ω–µ–ø—Ä–∞–≤–∏–ª—å–Ω—ã–π Client Secret
- `403 Forbidden` ‚Äî –Ω–µ—Ç –¥–æ—Å—Ç—É–ø–∞ –∫ email (–ø—Ä–æ–≤–µ—Ä—å—Ç–µ scope)
- `404 Not Found` ‚Äî –Ω–µ–ø—Ä–∞–≤–∏–ª—å–Ω—ã–π Client ID

---

## üîç –î–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∞

### –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ø—Ä–∞–≤–∏–ª—å–Ω–æ—Å—Ç—å OAuth App:

‚úÖ **OAuth App –∏–º–µ–µ—Ç:**
- Client ID –≤–∏–¥–∞: `Iv1.xxxxx`
- –°—Ç—Ä–∞–Ω–∏—Ü–∞ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ –≤ —Ä–∞–∑–¥–µ–ª–µ "OAuth Apps"
- –í–æ–∑–º–æ–∂–Ω–æ—Å—Ç—å —É–∫–∞–∑–∞—Ç—å —Ç–æ–ª—å–∫–æ callback URL (–Ω–µ webhook)

‚ùå **GitHub App –∏–º–µ–µ—Ç:**
- App ID (—á–∏—Å–ª–æ)
- –°—Ç—Ä–∞–Ω–∏—Ü–∞ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ –≤ —Ä–∞–∑–¥–µ–ª–µ "GitHub Apps"
- –ù–∞—Å—Ç—Ä–æ–π–∫–∏ webhook, permissions, –∏ —Ç.–¥.

---

## üìù –ü—Ä–æ–≤–µ—Ä–∫–∞ —Ä–∞–±–æ—Ç—ã

–ü–æ—Å–ª–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏:

1. –û—Ç–∫—Ä–æ–π—Ç–µ https://real-time-information.onrender.com/auth.html
2. –ù–∞–∂–º–∏—Ç–µ "–í–æ–π—Ç–∏ —á–µ—Ä–µ–∑ GitHub"
3. –î–æ–ª–∂–Ω–æ –ø–µ—Ä–µ–Ω–∞–ø—Ä–∞–≤–∏—Ç—å –Ω–∞ GitHub –¥–ª—è –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏
4. –ü–æ—Å–ª–µ –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏ –¥–æ–ª–∂–Ω–æ –≤–µ—Ä–Ω—É—Ç—å –≤ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ

–ï—Å–ª–∏ –≤—Å–µ —Ä–∞–±–æ—Ç–∞–µ—Ç:
- ‚úÖ –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å —Å–æ–∑–¥–∞–Ω/–Ω–∞–π–¥–µ–Ω
- ‚úÖ –¢–æ–∫–µ–Ω —Å–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞–Ω
- ‚úÖ –†–µ–¥–∏—Ä–µ–∫—Ç –Ω–∞ –≥–ª–∞–≤–Ω—É—é —Å—Ç—Ä–∞–Ω–∏—Ü—É

–ï—Å–ª–∏ –æ—à–∏–±–∫–∞:
- –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ª–æ–≥–∏ Render
- –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è OAuth App, –∞ –Ω–µ GitHub App
- –ü—Ä–æ–≤–µ—Ä—å—Ç–µ, —á—Ç–æ –≤—Å–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è –ø—Ä–∞–≤–∏–ª—å–Ω–æ —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω—ã

---

## üí° –ë—ã—Å—Ç—Ä–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞

–û—Ç–∫—Ä–æ–π—Ç–µ –≤ –±—Ä–∞—É–∑–µ—Ä–µ:
```
https://real-time-information.onrender.com/auth/github
```

–ï—Å–ª–∏ OAuth –Ω–∞—Å—Ç—Ä–æ–µ–Ω –ø—Ä–∞–≤–∏–ª—å–Ω–æ:
- ‚úÖ –ü—Ä–æ–∏–∑–æ–π–¥–µ—Ç —Ä–µ–¥–∏—Ä–µ–∫—Ç –Ω–∞ GitHub –¥–ª—è –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏

–ï—Å–ª–∏ –Ω–µ –Ω–∞—Å—Ç—Ä–æ–µ–Ω:
- ‚ùå –í–µ—Ä–Ω–µ—Ç—Å—è –æ—à–∏–±–∫–∞ 503 —Å —Å–æ–æ–±—â–µ–Ω–∏–µ–º "GitHub OAuth –Ω–µ –Ω–∞—Å—Ç—Ä–æ–µ–Ω"

